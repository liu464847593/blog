## XSS
攻击者想尽一切办法将可以执行的代码注入到网页中。利用这些恶意脚本，攻击者可获取用户的敏感信息如 Cookie、SessionID 等，进而危害数据安全

### XSS注入方法
- 在 HTML 中内嵌的文本中，恶意内容以 `script` 标签形成注入。
- 在内联的 `JavaScript` 中，拼接的数据突破了原本的限制（字符串，变量，方法名等）。
- 在标签属性中，恶意内容包含引号，从而突破属性值的限制，注入其他属性或者标签。
- 在标签的 `href`、`src` 等属性中，包含 `javascript:` 等可执行代码。
- 在 `onload`、`onerror`、`onclick` 等事件中，注入不受控制代码。
- 在 `style` 属性和标签中，包含类似 `background-image:url("javascript:...");` 的代码（新版本浏览器已经可以防范）。
- 在 `style` 属性和标签中，包含类似 `expression(...)` 的 CSS 表达式代码（新版本浏览器已经可以防范）。

### XSS分类
- 存储型
- 反射型
- DOM型

#### 存储型 XSS
存储型 XSS 的攻击步骤：

1. 攻击者将恶意代码提交到目标网站的数据库中。
2. 用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在 HTML 中返回给浏览器。
3. 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
4. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。  

这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。

#### 反射型 XSS
反射型 XSS 的攻击步骤：

1. 攻击者构造出特殊的 URL，其中包含恶意代码。
2. 用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。
3. 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
4. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。
5. 反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。

反射型 XSS 漏洞常见于通过 URL 传递参数的功能，如网站搜索、跳转等。

由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。

POST 的内容也可以触发反射型 XSS，只不过其触发条件比较苛刻（需要构造表单提交页面，并引导用户点击），所以非常少见。

#### DOM 型 XSS
DOM 型 XSS 的攻击步骤：

1. 攻击者构造出特殊的 URL，其中包含恶意代码。
2. 用户打开带有恶意代码的 URL。
3. 用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。
4. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

DOM 型 XSS 跟前两种 XSS 的区别：DOM 型 XSS 攻击中，取出和执行恶意代码由浏览器端完成，属于前端 JavaScript 自身的安全漏洞，而其他两种 XSS 
都属于服务端的安全漏洞。

### 如何防御
- 转义字符
转义输入输出的内容，对于`引号`、`尖括号`、`斜杠`进行转义

- `Content Security Policy (CSP)`  
  `CSP` 本质上就是建立白名单，开发者明确告诉浏览器哪些外部资源可以加载和执行。我们只需要配置规则，如何拦截是由浏览器自己实现的。我们可以通过
  这种方式来尽量减少 `XSS` 攻击。
  + 设置 `HTTP Header` 中的 `Content-Security-Policy`
  + 设置 `meta` 标签的方式 `<meta http-equiv="Content-Security-Policy">`
  
- 输入内容长度控制
对于不受信任的输入，都应该限定一个合理的长度。虽然无法完全防止 XSS 发生，但可以增加 XSS 攻击的难度  
- 其他安全措施
  + `HTTP-only Cookie`: 禁止 JavaScript 读取某些敏感 Cookie，攻击者完成 XSS 注入后也无法窃取此 Cookie。
  + 验证码：防止脚本冒充用户提交危险操作。
  
## CSRF
`CSRF` 中文名为`跨站请求伪造`。原理就是攻击者构造出一个后端请求地址，诱导用户点击或者通过某些途径自动发起请求。如果用户是在登录状态下的话，后端
就以为是用户在操作，从而进行相应的逻辑。

### 如何防御
- `Get` 请求不对数据进行修改
- `Samesite Cookie` 不让第三方网站访问到用户 `Cookie`
- 同源检测,阻止第三方网站请求接口
- 请求时附带验证信息，比如验证码或者 `Token`

## 点击劫持
点击劫持是一种视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 `iframe` 嵌套的方式嵌入自己的网页中，并将 `iframe` 设置为透明，在页面中透出一个
按钮诱导用户点击。

### 如何防御
- `X-FRAME-OPTIONS`   
`X-FRAME-OPTIONS` 是一个 HTTP 响应头，在现代浏览器有一个很好的支持。这个 `HTTP` 响应头 就是为了防御用 `iframe` 嵌套的点击劫持攻击。
- `JS防御`    
通过 `iframe` 的方式加载页面时，攻击者的网页直接不显示所有内容了。

## 中间人攻击
中间人攻击是攻击方同时与服务端和客户端建立起了连接，并让对方认为连接是安全的，但是实际上整个通信过程都被攻击者控制了。攻击者不仅能获得双方的
通信信息，还能修改通信信息。

### 如何防御 
- 建议使用公共的 `Wi-Fi`
- `HTTPS` 就可以用来防御中间人攻击，